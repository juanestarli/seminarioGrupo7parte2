{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport { ButtonProps } from \"react-native-web/dist/index\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { Camera } from 'expo-camera';\nimport { useState, useEffect, useRef } from 'react';\nimport { BarCodeScanner } from 'expo-barcode-scanner';\nimport { useIsFocused } from '@react-navigation/native';\nimport { useNavigation } from '@react-navigation/native';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar ScanPage = function ScanPage() {\n  var navigation = useNavigation();\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    hasCameraPermission = _useState2[0],\n    setHasCameraPermission = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    scanData = _useState4[0],\n    setScanData = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    imagen = _useState6[0],\n    setImagen = _useState6[1];\n  var _useState7 = useState(Camera.Constants.Type.back),\n    _useState8 = _slicedToArray(_useState7, 2),\n    type = _useState8[0],\n    setType = _useState8[1];\n  var _useState9 = useState(Camera.Constants.FlashMode.off),\n    _useState10 = _slicedToArray(_useState9, 2),\n    flash = _useState10[0],\n    setFlash = _useState10[1];\n  var cameraRef = useRef(null);\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var cameraStatus = yield BarCodeScanner.requestPermissionsAsync();\n      setHasCameraPermission(cameraStatus.status === 'granted');\n    })();\n  }, []);\n  if (hasCameraPermission === false) {\n    return _jsx(Text, {\n      children: \"Sin acceso a la camara\"\n    });\n  }\n  var handleBarCodeScanned = function handleBarCodeScanned(_ref2) {\n    var type = _ref2.type,\n      data = _ref2.data;\n    setScanData(data);\n    console.log(\"Data: \" + data);\n    console.log(\"Type: \" + type);\n    getNameProduct(data);\n  };\n  var getNameProduct = function () {\n    var _ref3 = _asyncToGenerator(function* (data) {\n      var response = yield fetch(\"https://world.openfoodfacts.org/api/v0/product/\" + data + \".json\");\n      var json = yield response.json();\n      var productName = json.product.product_name;\n      console.log(productName);\n      yield AsyncStorage.setItem('nombreProducto', productName);\n      var nombreProducto = yield AsyncStorage.getItem('nombreProducto');\n    });\n    return function getNameProduct(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var validarProducto = function () {\n    var _ref4 = _asyncToGenerator(function* (data) {\n      var response = yield fetch(\"https://world.openfoodfacts.org/api/v0/product/\" + data + \".json\");\n      var json = yield response.json();\n      var productData = json.product;\n      console.log(productData.product);\n      var ingredients = productData.ingredients;\n    });\n    return function validarProducto(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var viewFocused = useIsFocused();\n  return _jsxs(View, {\n    style: styles.container,\n    children: [viewFocused && _jsx(Camera, {\n      onBarCodeScanned: scanData ? undefined : handleBarCodeScanned,\n      style: StyleSheet.absoluteFillObject\n    }), scanData && _jsx(Button, {\n      color: \"#F17F16\",\n      title: 'Escanear otra vez',\n      onPress: function onPress() {\n        return setScanData(undefined);\n      }\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignSelf: 'center',\n    width: Dimensions.get('screen').width - 15,\n    height: Dimensions.get('screen').height,\n    overflow: 'hidden',\n    flexDirection: 'column-reverse',\n    borderTopStartRadius: 50,\n    borderTopEndRadius: 50,\n    borderBottomStartRadius: 30,\n    borderBottomEndRadius: 30,\n    marginTop: 80,\n    marginBottom: 20,\n    borderWidth: 5,\n    borderColor: \"grey\"\n  },\n  wrapper: {\n    alignContent: \"center\",\n    width: 100,\n    height: 100\n  }\n});\nexport default ScanPage;","map":{"version":3,"names":["ButtonProps","TouchableOpacity","Camera","useState","useEffect","useRef","BarCodeScanner","useIsFocused","useNavigation","AsyncStorage","jsx","_jsx","jsxs","_jsxs","ScanPage","navigation","_useState","_useState2","_slicedToArray","hasCameraPermission","setHasCameraPermission","_useState3","_useState4","scanData","setScanData","_useState5","_useState6","imagen","setImagen","_useState7","Constants","Type","back","_useState8","type","setType","_useState9","FlashMode","off","_useState10","flash","setFlash","cameraRef","_asyncToGenerator","cameraStatus","requestPermissionsAsync","status","Text","children","handleBarCodeScanned","_ref2","data","console","log","getNameProduct","_ref3","response","fetch","json","productName","product","product_name","setItem","nombreProducto","getItem","_x","apply","arguments","validarProducto","_ref4","productData","ingredients","_x2","viewFocused","View","style","styles","container","onBarCodeScanned","undefined","StyleSheet","absoluteFillObject","Button","color","title","onPress","create","flex","alignSelf","width","Dimensions","get","height","overflow","flexDirection","borderTopStartRadius","borderTopEndRadius","borderBottomStartRadius","borderBottomEndRadius","marginTop","marginBottom","borderWidth","borderColor","wrapper","alignContent"],"sources":["C:/Users/tomas/Documents/seminario-ok-ok/seminarioGrupo7parte2/screens/ScanPage.js"],"sourcesContent":["import { StyleSheet, Text, View, Image ,Dimensions ,Alert, Button, ButtonProps, TouchableOpacity} from 'react-native';\r\nimport { Camera} from 'expo-camera';\r\nimport { useState, useEffect, useRef } from 'react';\r\nimport { BarCodeScanner } from 'expo-barcode-scanner';\r\nimport {useIsFocused} from '@react-navigation/native';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\n\r\nconst ScanPage = () => {\r\n  const navigation = useNavigation();\r\n  \r\n  //Variables lector de barra\r\n  const [hasCameraPermission, setHasCameraPermission] = useState(null);\r\n  const [scanData, setScanData] = useState(null);\r\n  \r\n  //Variables camara\r\n  const [imagen, setImagen] = useState(null);\r\n  const [type, setType] = useState(Camera.Constants.Type.back) //Camara trasera\r\n  const [flash, setFlash] = useState(Camera.Constants.FlashMode.off) //Desactivamos el flash\r\n  const cameraRef = useRef(null);\r\n\r\n\r\n  useEffect(() => {\r\n    (async () =>{\r\n      const cameraStatus = await BarCodeScanner.requestPermissionsAsync(); //Pedimos permiso para acceder a la camara\r\n      setHasCameraPermission(cameraStatus.status === 'granted');\r\n    })();\r\n  },[])\r\n\r\n  if(hasCameraPermission === false){\r\n    return <Text>Sin acceso a la camara</Text>\r\n  }\r\n\r\n  const handleBarCodeScanned = ({type, data}) => {\r\n    setScanData(data);\r\n    console.log(`Data: ${data}`);\r\n    console.log(`Type: ${type}`); \r\n    getNameProduct(data);\r\n    \r\n  }\r\n\r\n  const getNameProduct = async (data) => {\r\n    const response = await fetch(`https://world.openfoodfacts.org/api/v0/product/${data}.json`)\r\n    const json = await response.json();\r\n    const productName=json.product.product_name;\r\n    console.log(productName)\r\n    await AsyncStorage.setItem('nombreProducto', productName);\r\n    const nombreProducto= await AsyncStorage.getItem('nombreProducto');\r\n  }\r\n\r\n  const validarProducto = async (data) => {\r\n      const response = await fetch(`https://world.openfoodfacts.org/api/v0/product/${data}.json`);\r\n      const json = await response.json();\r\n      const productData = json.product; \r\n      console.log(productData.product);\r\n      const ingredients=productData.ingredients;\r\n  }\r\n\r\n  ;\r\n\r\n  //useIsFocused returns a boolean indicating whether the screen is focused or not\r\n  const viewFocused = useIsFocused();\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      {viewFocused &&\r\n      <Camera\r\n        onBarCodeScanned={scanData ? undefined : handleBarCodeScanned}\r\n        style={StyleSheet.absoluteFillObject}\r\n      />}\r\n      {scanData && <Button \r\n                    color= {\"#F17F16\"}\r\n                    title={'Escanear otra vez'} \r\n                    onPress={() => setScanData(undefined)}\r\n                    />  \r\n      }\r\n   </View>\r\n  );\r\n}\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    alignSelf:'center',\r\n    width:Dimensions.get('screen').width-15,\r\n    height:Dimensions.get('screen').height,\r\n    overflow:'hidden',\r\n    flexDirection:'column-reverse',\r\n    borderTopStartRadius:50,\r\n    borderTopEndRadius:50,\r\n    borderBottomStartRadius:30,\r\n    borderBottomEndRadius:30,\r\n    marginTop:80,\r\n    marginBottom:20,\r\n    borderWidth:5,\r\n    borderColor:\"grey\"\r\n  },\r\n  wrapper: {\r\n    alignContent: \"center\",\r\n    width: 100,\r\n    height: 100,\r\n  }\r\n});\r\n\r\nexport default ScanPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}